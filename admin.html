<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Admin - ZarzƒÖdzanie</title>
    <style>
        body { background: #000; color: white; font-family: sans-serif; display: flex; margin: 0; }
        .sidebar { width: 220px; background: #111; height: 100vh; padding: 20px; border-right: 1px solid #333; position: fixed; }
        .main { margin-left: 260px; padding: 20px; flex: 1; }
        .card { background: #1a1a1a; padding: 15px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #333; }
        .btn { padding: 8px 12px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; }
        .btn-v { background: #00ff00; color: black; }
        .btn-del { background: #ff4444; color: white; }
        .badge { width: 15px; vertical-align: middle; }
    </style>
</head>
<body>
<div class="sidebar">
    <h2>Panel Admina</h2>
    <button onclick="loadUsers()" style="width:100%; height:40px; cursor:pointer; margin-bottom:10px;">üë• U≈ªYTKOWNICY</button>
    <button onclick="location.href='index.html'" style="width:100%; height:40px; cursor:pointer;">üè† POWR√ìT</button>
</div>
<div class="main" id="adminMain">Witaj w panelu. Wybierz opcjƒô z lewej.</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyCpp-nUIT7bHmtO8qJI3-Q89biIpsnIBzM", authDomain: "polski-youtub2.firebaseapp.com", projectId: "polski-youtub2", storageBucket: "polski-youtub2.firebasestorage.app", messagingSenderId: "325129789226", appId: "1:325129789226:web:f68f2f1a1f8f9feaf14853" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const V_IMG = "https://th.bing.com/th/id/R.503a526f8f8634741fb17f6c9d4d703e?rik=0GG6forTzHaljQ&pid=ImgRaw&r=0";

    window.loadUsers = async () => {
        const main = document.getElementById('adminMain');
        main.innerHTML = "Wczytywanie u≈ºytkownik√≥w...";
        const snap = await getDocs(collection(db, "users"));
        main.innerHTML = "<h2>ZarzƒÖdzaj WeryfikacjƒÖ</h2>";
        snap.forEach(d => {
            const u = d.data();
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                <b>${d.id}</b> ${u.verified ? `<img src="${V_IMG}" class="badge">` : ''}
                <div style="margin-top:10px">
                    <button class="btn btn-v" onclick="toggleV('${d.id}', ${!u.verified})">
                        ${u.verified ? 'Zabierz V' : 'Daj V'}
                    </button>
                </div>
            `;
            main.appendChild(div);
        });
    };

    window.toggleV = async (email, status) => {
        await updateDoc(doc(db, "users", email), { verified: status });
        alert("Zmieniono status weryfikacji!");
        loadUsers();
    };
</script>
</body>
</html>
