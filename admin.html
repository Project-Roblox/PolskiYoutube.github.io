<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Panel mikih9a</title>
    <style>
        body { background: #000; color: white; font-family: sans-serif; display: flex; margin: 0; }
        .sidebar { width: 220px; background: #111; height: 100vh; padding: 20px; border-right: 1px solid #333; }
        .main { flex: 1; padding: 20px; overflow-y: auto; }
        .card { background: #1a1a1a; padding: 15px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #333; }
        .btn { padding: 5px 10px; border-radius: 5px; border: none; cursor: pointer; font-weight: bold; }
        .btn-red { background: #ff4444; color: white; }
        .btn-blue { background: #3ea6ff; color: black; }
        input { background: #222; border: 1px solid #444; color: white; padding: 5px; margin-right: 5px; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>mikih9a Panel</h2>
    <hr>
    <button onclick="loadSection('vids')" style="width:100%; height:40px; margin-bottom:10px;">üé¨ FILMY</button>
    <button onclick="loadSection('support')" style="width:100%; height:40px;">üí¨ SUPPORT</button>
</div>

<div class="main" id="content">Wybierz sekcjƒô z lewej strony</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, updateDoc, deleteDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyCpp-nUIT7bHmtO8qJI3-Q89biIpsnIBzM", authDomain: "polski-youtub2.firebaseapp.com", projectId: "polski-youtub2", storageBucket: "polski-youtub2.firebasestorage.app", messagingSenderId: "325129789226", appId: "1:325129789226:web:f68f2f1a1f8f9feaf14853", measurementId: "G-B5M3F5J713" };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.loadSection = async (s) => {
        const main = document.getElementById('content');
        main.innerHTML = "Wczytywanie...";
        
        if(s === 'vids') {
            const snap = await getDocs(collection(db, "content"));
            main.innerHTML = "<h1>ZarzƒÖdzanie Filmami</h1>";
            snap.forEach(d => {
                const data = d.data();
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <b>${data.title}</b> | Autor: ${data.author}<br><br>
                    Lajki: <input type="number" id="l-${d.id}" value="${data.likes}"> 
                    Wy≈õw: <input type="number" id="v-${d.id}" value="${data.views}">
                    <button class="btn btn-blue" onclick="saveStat('${d.id}')">ZAPISZ</button>
                    <button class="btn btn-red" onclick="del('${d.id}')">USU≈É</button>
                    <button class="btn" onclick="verify('${data.author}')">DAJ ‚úîÔ∏è</button>
                `;
                main.appendChild(div);
            });
        }
        
        if(s === 'support') {
            const snap = await getDocs(collection(db, "support"));
            main.innerHTML = "<h1>Wiadomo≈õci Support</h1>";
            snap.forEach(d => {
                const data = d.data();
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `<b>Od: ${data.userEmail}</b><p>${data.messages[0].text}</p>
                <input type="text" placeholder="Twoja odpowied≈∫..."><button class="btn btn-blue">ODPISZ</button>`;
                main.appendChild(div);
            });
        }
    };

    window.saveStat = async (id) => {
        const l = document.getElementById(`l-${id}`).value;
        const v = document.getElementById(`v-${id}`).value;
        await updateDoc(doc(db, "content", id), { likes: parseInt(l), views: parseInt(v) });
        alert("Zapisano!");
    };

    window.del = async (id) => { if(confirm("UsunƒÖƒá?")) { await deleteDoc(doc(db, "content", id)); location.reload(); }};
    
    window.verify = async (email) => {
        await setDoc(doc(db, "users", email), { verified: true }, { merge: true });
        alert("Zweryfikowano " + email);
    };
</script>
</body>
</html>
