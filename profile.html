<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Profil - Polski YouTube</title>
    <style>
        body { background: #0f0f0f; color: white; font-family: sans-serif; margin: 0; }
        .header { padding: 40px 20px; background: #1a1a1a; text-align: center; border-bottom: 1px solid #333; }
        .container { max-width: 1200px; margin: auto; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 40px; }
        .v-card { cursor: pointer; background: #111; border-radius: 8px; overflow: hidden; border: 1px solid #333; }
        .v-card video { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
        .short-card { cursor: pointer; background: #111; border-radius: 8px; overflow: hidden; border: 1px solid #333; }
        .short-card video { width: 100%; aspect-ratio: 9/16; object-fit: cover; }
        .badge { color: #3ea6ff; font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <h1 id="userTitle">Profil u≈ºytkownika</h1>
    <button onclick="location.href='index.html'" style="background:#333; color:white; border:none; padding:10px 20px; border-radius:20px; cursor:pointer;">‚Üê Powr√≥t</button>
</div>

<div class="container">
    <h3 id="vCount">üé• Filmy (0)</h3>
    <div id="videoGrid" class="grid"></div>

    <h3 id="sCount">üì± Shortsy (0)</h3>
    <div id="shortsGrid" class="grid" style="grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, query, where, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCpp-nUIT7bHmtO8qJI3-Q89biIpsnIBzM",
        authDomain: "polski-youtub2.firebaseapp.com",
        projectId: "polski-youtub2",
        storageBucket: "polski-youtub2.firebasestorage.app",
        messagingSenderId: "325129789226",
        appId: "1:325129789226:web:f68f2f1a1f8f9feaf14853",
        measurementId: "G-B5M3F5J713"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const params = new URLSearchParams(location.search);
    const userEmail = params.get('u');

    async function loadProfile() {
        if(!userEmail) return;
        
        // Sprawd≈∫ weryfikacjƒô dla nag≈Ç√≥wka
        const uSnap = await getDoc(doc(db, "users", userEmail));
        const badge = (uSnap.exists() && uSnap.data().verified) ? ' <span class="badge">‚úîÔ∏è</span>' : '';
        document.getElementById('userTitle').innerHTML = userEmail + badge;

        const q = query(collection(db, "content"), where("author", "==", userEmail));
        const snap = await getDocs(q);
        
        let vNum = 0, sNum = 0;

        snap.forEach(d => {
            const data = d.data();
            const div = document.createElement('div');
            div.onclick = () => location.href = `video.html?id=${d.id}`;
            div.innerHTML = `<video src="${data.url}#t=0.1"></video><p style="padding:10px; margin:0; font-size:13px;">${data.title}</p>`;

            if(data.type === 'short') {
                div.className = 'short-card';
                document.getElementById('shortsGrid').appendChild(div);
                sNum++;
            } else {
                div.className = 'v-card';
                document.getElementById('videoGrid').appendChild(div);
                vNum++;
            }
        });

        document.getElementById('vCount').innerText = `üé• Filmy (${vNum})`;
        document.getElementById('sCount').innerText = `üì± Shortsy (${sNum})`;
    }

    loadProfile();
</script>
</body>
</html>
